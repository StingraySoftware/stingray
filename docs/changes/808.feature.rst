Speed up computation of pds for large arrays
